# ZullaWpf - Dance Class Manager

A complete MVVM + CRUD WPF application with SQL Server integration.

## Architecture

### Projects Structure

1. **ZullaWpfDomain** - Domain layer containing:
   - Commands (CreateDanceClassCommand, UpdateDanceClassCommand, DeleteDanceClassCommand)
   - Models (DanceClass)
   - Queries (GetAllDanceClassesQuery)
   - Interfaces (ICommandHandler, IQueryHandler)

2. **ZullaWpfFramework** - Data access layer containing:
   - Commands (Command handlers for CRUD operations)
   - DTOs (DanceClassDto)
   - Queries (Query handlers)
   - ZullaWpfDbContext (Entity Framework DbContext)
   - ZullaWpfDbContextFactory (Design-time factory for migrations)

3. **ZullaWpf** - Presentation layer containing:
   - Commands (RelayCommand, AsyncRelayCommand)
   - Converters (BoolToSaveUpdateConverter)
   - HostBuilders (Dependency injection setup)
   - ViewModels (MainViewModel, DanceClassViewModel, ViewModelBase)
   - Views (MainWindow.xaml)
   - App.xaml with DI configuration
   - appsettings.json with connection string

## Setup Instructions

### 1. Update Connection String

Edit `ZullaWpf/appsettings.json` and update the connection string if needed:

```json
{
  "ConnectionStrings": {
    "DefaultConnection": "Data Source=(localdb)\\MSSQLLocalDB;Initial Catalog=ZullaWpfDb;Integrated Security=True;Connect Timeout=30;Encrypt=False;TrustServerCertificate=False;ApplicationIntent=ReadWrite;MultiSubnetFailover=False"
  }
}
```

### 2. Create Database Migration

Open Package Manager Console in Visual Studio and run:

```powershell
Add-Migration InitialCreate -Project ZullaWpfFramework -StartupProject ZullaWpf
```

### 3. Update Database

Apply the migration to create the database:

```powershell
Update-Database -Project ZullaWpfFramework -StartupProject ZullaWpf
```

### 4. Run the Application

Build and run the ZullaWpf project. The application will:
- Connect to SQL Server LocalDB
- Display all dance classes in the DataGrid
- Allow you to add, edit, and delete dance classes

## Features

- **Add**: Fill in the form and click "Save" to add a new dance class
- **Edit**: Select a row in the DataGrid, modify the fields, and click "Update"
- **Delete**: Select a row and click "Delete" (only enabled for existing records)
- **Clear**: Clear the form to start fresh
- **Auto-refresh**: DataGrid automatically refreshes after add/update/delete operations

## MVVM Pattern

- **Models**: Domain entities (DanceClass)
- **ViewModels**: MainViewModel, DanceClassViewModel with INotifyPropertyChanged
- **Views**: MainWindow.xaml with data binding
- **Commands**: ICommand implementations for user actions
- **Dependency Injection**: Microsoft.Extensions.Hosting for DI container

## Database

The application uses Entity Framework Core with SQL Server LocalDB. The connection string is flexible and can be changed in appsettings.json to point to any SQL Server instance.

## Notes

- Only records that have been saved to the database can be edited or deleted
- The ID field is auto-generated by the database
- All fields are required
- The application uses async/await for all database operations
